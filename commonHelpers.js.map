{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export function renderMarkup(arr) {\n  return arr\n    .map(item => `\n      <li class=\"gallery-item\">\n        <a href=\"${item.largeImageURL}\">\n          <div class=\"image-container\">\n            <img src=\"${item.webformatURL}\" alt=\"${item.tags}\" width=\"360\" height=\"200\" loading=\"lazy\">\n          </div>\n          <ul class=\"photo-dsc\">\n            <li>\n              <p class=\"photo-dsc-title\">Likes</p>\n              <p class=\"photo-dsc-text\">${item.likes}</p>\n            </li>\n            <li>\n              <p class=\"photo-dsc-title\">Views</p>\n              <p class=\"photo-dsc-text\">${item.views}</p>\n            </li>\n            <li>\n              <p class=\"photo-dsc-title\">Comments</p>\n              <p class=\"photo-dsc-text\">${item.comments}</p>\n            </li>\n            <li>\n              <p class=\"photo-dsc-title\">Downloads</p>\n              <p class=\"photo-dsc-text\">${item.downloads}</p>\n            </li>\n          </ul>\n        </a>\n      </li>\n    `)\n    .join('');\n}\n","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(searchValue, page = 1, perPage = 15) {\n  const searchParams = new URLSearchParams({\n    key: '45041443-5e59051ebb139c7689a42bd95',\n    q: searchValue,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page: page,\n    per_page: perPage,\n  });\n\n  try {\n    const response = await axios.get(`?${searchParams}`);\n    return response.data;\n  } catch (error) {\n    throw new Error(error.response.status);\n  }\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { renderMarkup } from './js/render-functions';\nimport { fetchImages } from './js/pixabay-api';\n\nexport const refs = {\n  formSearchEl: document.querySelector('.form-search'),\n  galleryListEl: document.querySelector('.gallery-list'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.load-more'),\n};\n\nrefs.loader.classList.add('loader-hidden');\nrefs.loadMoreBtn.classList.add('hidden');\n\nlet query = '';\nlet page = 1;\nlet totalHits = 0;\n\nrefs.formSearchEl.addEventListener('submit', onSearch);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSearch(e) {\n  e.preventDefault();\n\n  query = refs.formSearchEl.elements.search.value.trim();\n  if (!query) return;\n\n  refs.galleryListEl.innerHTML = '';\n  refs.loader.classList.remove('loader-hidden');\n  refs.loadMoreBtn.classList.add('hidden');\n  page = 1;\n\n  try {\n    const data = await fetchImages(query, page, 15);\n    totalHits = data.totalHits;\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        backgroundColor: '#ef4040',\n        messageColor: '#fafafb',\n        position: 'topRight',\n        progressBarColor: '#fafafb',\n      });\n      return;\n    }\n\n    refs.galleryListEl.innerHTML = renderMarkup(data.hits);\n    gallery.refresh();\n    if (data.hits.length === 15 && refs.galleryListEl.children.length < totalHits) {\n      refs.loadMoreBtn.classList.remove('hidden');\n    }\n  } catch (error) {\n    iziToast.error({\n      message: `Error: ${error.message}`,\n      backgroundColor: '#ef4040',\n      messageColor: '#fafafb',\n      position: 'topRight',\n      progressBarColor: '#fafafb',\n    });\n  } finally {\n    refs.loader.classList.add('loader-hidden');\n  }\n\n  refs.formSearchEl.elements.search.value = '';\n}\n\nasync function onLoadMore() {\n  page += 1;\n  refs.loader.classList.remove('loader-hidden');\n  refs.loadMoreBtn.classList.add('hidden');\n\n  try {\n    const data = await fetchImages(query, page, 15);\n    refs.galleryListEl.insertAdjacentHTML('beforeend', renderMarkup(data.hits));\n    gallery.refresh();\n    \n    const { height: cardHeight } = refs.galleryListEl.firstElementChild.getBoundingClientRect();\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    if (refs.galleryListEl.children.length >= totalHits) {\n      refs.loadMoreBtn.classList.add('hidden');\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        backgroundColor: '#00a0dc',\n        messageColor: '#fafafb',\n        position: 'topRight',\n        progressBarColor: '#fafafb',\n      });\n    } else if (data.hits.length === 15) {\n      refs.loadMoreBtn.classList.remove('hidden');\n    }\n  } catch (error) {\n    iziToast.error({\n      message: `Error: ${error.message}`,\n      backgroundColor: '#ef4040',\n      messageColor: '#fafafb',\n      position: 'topRight',\n      progressBarColor: '#fafafb',\n    });\n  } finally {\n    refs.loader.classList.add('loader-hidden');\n  }\n}\n\nconst gallery = new SimpleLightbox('.gallery-list a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});"],"names":["renderMarkup","arr","item","axios","fetchImages","searchValue","page","perPage","searchParams","error","refs","query","totalHits","onSearch","onLoadMore","e","data","iziToast","gallery","cardHeight","SimpleLightbox"],"mappings":"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"}